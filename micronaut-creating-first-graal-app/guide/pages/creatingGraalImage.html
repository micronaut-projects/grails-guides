<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <title>5.1 Creating GraalVM native image null</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8"/>
    <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8"/>
    <script type="text/javascript">
function addJsClass() {
    var classes = document.body.className.split(" ");
    classes.push("js");
    document.body.className = classes.join(" ");
}
    </script>
</head>

<body class="body" onload="addJsClass();">
<div id="navigation">
    <div class="navTitle">
        
        Creating your first Micronaut Graal application
    </div>
    <div class="navLinks">
        <ul>
            <li>
                <div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)">
                    <a href="../../guide/index.html" class="button">Table of contents</a>

                    <div id="nav-summary-childs" style="display:none;">
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/gettingStarted.html"><strong>1</strong><span>Getting Started</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/writingTheApp.html"><strong>2</strong><span>Writing the App</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/service.html"><strong>3</strong><span>Service</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/controller.html"><strong>4</strong><span>Controller</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/graal.html"><strong>5</strong><span>Adding GraalVM support</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/nextSteps.html"><strong>6</strong><span>Next steps</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/help.html"><strong>7</strong><span>Help with Micronaut</span></a>
                        </div>
                        
                    </div>
                </div>
            </li>
            <li class="separator selected">
                <a id="ref-button" onclick="localToggle(); return false;" href="#">Quick Reference</a>
            </li>
        </ul>
    </div>


</div>

<table id="colset" border="0" cellpadding="0" cellspacing="0">
    <tr>
        <td id="col1">
            <div id="main" class="corner-all">

                
                    <div class="toc-item prev-left"><a href="../../guide/controller.html">&lt;&lt; <strong>4</strong><span>Controller</span></a></div>
                

                <span id='toggle-col1' class="toggle">(<a href="#" onclick="localToggle(); return false;">Quick Reference</a>)</span>

                
                    <div class="toc-item next-right"><a href="../../guide/nextSteps.html"><strong>6</strong><span>Next steps</span> >></a></div>
                


                <div class="project">
                    <h1>5.1 Creating GraalVM native image</h1>

                    <p><strong>Version:</strong> null</p>
                </div>

                

                

<h2 id="creatingGraalImage">5.1 Creating GraalVM native image</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-guides/micronaut-creating-first-graal-app/edit/master/src/main/docs/guide/graal/creatingGraalImage.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>The GraalVM support has been improved in Micronaut 2.2.0 with a new <a href="https://micronaut-projects.github.io/micronaut-maven-plugin/latest/index.html">Micronaut Maven Plugin</a>
and Micronaut 2.1.0 already included a <a href="https://github.com/micronaut-projects/micronaut-gradle-plugin">Micronaut Gradle Plugin</a>.</p>
</div>
<div class="paragraph">
<p>Now everything is configured by the plugins and you don&#8217;t need to do anything to your application or select the
<code>graalvm</code> feature when creating the application.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This guide uses Gradle but it contains instructions for using the Maven plugin. To create the application with Maven
support run: <code>mn create-app hello-world --build maven</code>.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_installing_graalvm">Installing GraalVM</h3>
<div class="paragraph">
<p>The first step is installing GraalVM via the <a href="https://www.graalvm.org/docs/getting-started/">Getting Started</a> instructions or using SDKman:</p>
</div>
<div class="listingblock">
<div class="title">Installing GraalVM 20.3.0 with SDKman</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash" data-lang="bash">$ sdk install java 20.3.0.r8-grl # or 20.3.0.r11-grl for JDK 11</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>native-image</code> tool was extracted from the base GraalVM distribution. Currently, it is available as an early adopter plugin. To install it, run:</p>
</div>
<div class="listingblock">
<div class="title">Installing <code>native-image</code> tool</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash" data-lang="bash">$ gu install native-image <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>You only need to do that the first time to install the <code>native-image</code> tool.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_creating_native_image_outside_docker">Creating native image outside Docker</h3>
<div class="paragraph">
<p>To build your native image without using Docker is now really simple:</p>
</div>
<div class="listingblock">
<div class="title">Building Graal native image</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash" data-lang="bash">$ sdk use java 20.3.0.r8-grl

$ ./gradlew nativeImage</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or if you use Maven:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash" data-lang="bash">$ sdk use java 20.3.0.r8-grl

$ ./mvnw package -Dpackaging=native-image</code></pre>
</div>
</div>
<div class="paragraph">
<p>The previous command will create the native executable in <code>build/native-image</code> directory (or in <code>target</code> if you use Maven).</p>
</div>
<div class="paragraph">
<p>It is also possible to customize the name of the native image or pass additional parameters to GraalVM:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy" data-lang="groovy">nativeImage {
    args('--verbose')
    imageName('hello-world') <i class="conum" data-value="1"></i><b>(1)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The native image name will now be <code>micronaut-graalvm-app</code></td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_creating_native_image_inside_docker">Creating native image inside Docker</h3>
<div class="paragraph">
<p>The output following this approach is a docker image that runs the native image of your application. You don&#8217;t need to install
any additional dependency.</p>
</div>
<div class="listingblock">
<div class="title">Building Graal native image</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash" data-lang="bash">$ ./gradlew dockerBuildNative</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Building Graal native image with Maven</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash" data-lang="bash">$ ./mvnw package -Dpackaging=docker-native</code></pre>
</div>
</div>
<div class="paragraph">
<p>The previous command will create the image <code>hello-world:latest</code>. To execute it:</p>
</div>
<div class="listingblock">
<div class="title">Executing the native image</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash" data-lang="bash">$ docker run -p 8080:8080 complete
10:29:46.845 [main] INFO  io.micronaut.runtime.Micronaut - Startup completed in 12ms. Server Running: http://localhost:8080</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can see that the application starts in only 12ms.</p>
</div>
</div>
<div class="sect2">
<h3 id="_sending_a_request">Sending a request</h3>
<div class="paragraph">
<p>Start the application either using Docker or the native executable. You can run a few cURL requests to test the application:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash" data-lang="bash">complete $ time curl localhost:8080/conferences/random
{"name":"Greach"}
real    0m0.016s
user    0m0.005s
sys     0m0.004s

complete $ time curl localhost:8080/conferences/random
{"name":"GR8Conf EU"}
real    0m0.014s
user    0m0.005s
sys     0m0.004s</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For more information about the new plugins take a look at the <a href="https://github.com/micronaut-projects/micronaut-gradle-plugin">Micronaut Gradle plugin</a>
and <a href="https://micronaut-projects.github.io/micronaut-maven-plugin/latest/index.html">Micronaut Maven Plugin</a> documentation.
</td>
</tr>
</table>
</div>
</div>


                <div style="clear:both;margin-top:15px;"></div>
                
                    <div class="toc-item prev-left"><a href="../../guide/controller.html">&lt;&lt; <strong>4</strong><span>Controller</span></a></div>
                
                    <div class="toc-item next-right"><a href="../../guide/nextSteps.html"><strong>6</strong><span>Next steps</span> >></a></div>
                
                <div style="clear:both"></div>
            </div>
        </td>
        <td id="col2">
            <div class="local clearfix">
                <div class="local-title">
                    <a href="../../guide/index.html" target="mainFrame">Quick Reference</a>
                    <span class="toggle">(<a href="#" onclick="localToggle(); return false;">hide</a>)</span>
                </div>
                <div class="menu">
                    
                </div>
            </div>
        </td>
    </tr>
</table>

<div id="footer">
    Copies of this document may be made for your own use and for distribution to others, provided that you do not charge any fee for such copies and further provided that each copy contains this Copyright Notice, whether distributed in print or electronically. All guides are released with an ASLv2 license for the code, and Creative Commons license for the writing. 
    
</div>

<script type="text/javascript" src="../js/docs.js"></script>

</body>
</html>

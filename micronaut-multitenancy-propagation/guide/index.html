<!DOCTYPE html>
<html>
<head>
    <meta name='google-site-verification' content='REYQ1_I6HGowAE7LOLVqfQbnKaB4IfFpMlGzMbJj55Q' />
    <meta name='viewport' content='width=device-width, initial-scale=1' />
    <link rel='icon' href='../img/micronaut-favicon.ico' />
    <meta charset='UTF-8' />
    <title>Micronaut Multitenancy Propagation | Micronaut Guides | Micronaut Framework</title>
    <meta name='description' content='Micronaut Multitenancy Propagation. Learn how to Micronaut helps you implement Multitenancy in a set of Microservices.' />
    <link rel="stylesheet" href="../css/highlight/agate.css">
    <script src="../js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <link rel='stylesheet' href='../css/main.css' />
    <link rel='stylesheet' href='../css/screen.css' />
    <script src='https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js'></script>
</head>
<body class='guide'>
<div id="navigation">
    <div class="navTitle">
        <span id="logo"><a href="http://micronaut.io" title="Go to Micronaut Website"><img src="../img/micronaut-logo-white.svg" alt="Micronaut"/></a></span>
    </div>
    <div class="navLinks">
        <ul>
            <li>
                <a href="http://guides.micronaut.io">Micronaut Guides</a>
                <span> &rarr; </span>
                <a href="http://guides.micronaut.io/micronaut-multitenancy-propagation/guide/index.html">Micronaut Multitenancy Propagation</a>
            </li>
        </ul>

    </div>
</div>

<div class='fullwidth'><article class="guide">
    <aside>
        <a href="https://travis-ci.org/micronaut-guides/micronaut-multitenancy-propagation"><img src="https://travis-ci.org/micronaut-guides/micronaut-multitenancy-propagation.svg?branch=master"></a>

        <button type="button" class="btn btn-large" onclick="window.location.href=&quot;https://github.com/micronaut-guides/micronaut-multitenancy-propagation&quot;"><img height="15" src="../img/github_white.svg" alt="Github"/><span>&nbsp;Get the Code</span></button>


        <ul class="githublinks">
            <li><button type="button" class="btn btn-default" href="#" onclick="document.getElementById('github-url').value='git@github.com:micronaut-guides/micronaut-multitenancy-propagation.git'" class="codeButton">SSH</button></li>
            <li><button type="button" class="btn btn-default" onclick="document.getElementById('github-url').value='https://github.com/micronaut-guides/micronaut-multitenancy-propagation.git'" class="codeButton">HTTPS</button></li>
        </ul>
        <div class="input-group">
            <!-- Target -->
            <input id="github-url" value="git@github.com:micronaut-guides/micronaut-multitenancy-propagation.git" type="text" />
            <!-- Trigger -->
            <button type="button" class="clippy btn btn-default" type="button" data-clipboard-target="#github-url">
                <img width="13" src="../img/clippy.svg" alt="Copy to clipboard">
            </button>
        </div>
        <script>var clipboard = new Clipboard('.clippy');</script>
        <button type="button" class="btn btn-large" onclick="window.location.href=&quot;https://github.com/micronaut-guides/micronaut-multitenancy-propagation/archive/master.zip&quot;">Download ZIP</button>
        
        <div id="table-of-content">
            <h3>Table of Contents</h3>
            
            <div class="toc-item" style="margin-left:0px"><a href="#gettingStarted"><strong>1</strong><span>Getting Started</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#requirements"><strong>1.1</strong><span>What you will need</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#solution"><strong>1.2</strong><span>Solution</span></a></div>
            
            <div class="toc-item" style="margin-left:0px"><a href="#usingSnapshotVersion"><strong>2</strong><span>Using Snapshot Version</span></a></div>
            
            <div class="toc-item" style="margin-left:0px"><a href="#writingTheApp"><strong>3</strong><span>Writing the App</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#gateway"><strong>3.1</strong><span>Gateway</span></a></div>
            
            <div class="toc-item" style="margin-left:20px"><a href="#multitenancyconfiguration"><strong>3.1.1</strong><span>Multitenancy Configuration</span></a></div>
            
            <div class="toc-item" style="margin-left:20px"><a href="#filter"><strong>3.1.2</strong><span>Http Server Filter</span></a></div>
            
            <div class="toc-item" style="margin-left:20px"><a href="#client"><strong>3.1.3</strong><span>Http Client</span></a></div>
            
            <div class="toc-item" style="margin-left:20px"><a href="#homecontroller"><strong>3.1.4</strong><span>Home Controller</span></a></div>
            
            <div class="toc-item" style="margin-left:20px"><a href="#cookieRedirect"><strong>3.1.5</strong><span>Cookie Redirect</span></a></div>
            
            <div class="toc-item" style="margin-left:20px"><a href="#tests"><strong>3.1.6</strong><span>Tests</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#books"><strong>3.2</strong><span>Books Microservice</span></a></div>
            
            <div class="toc-item" style="margin-left:20px"><a href="#gorm"><strong>3.2.1</strong><span>GORM</span></a></div>
            
            <div class="toc-item" style="margin-left:20px"><a href="#domain"><strong>3.2.2</strong><span>Domain</span></a></div>
            
            <div class="toc-item" style="margin-left:20px"><a href="#dataservice"><strong>3.2.3</strong><span>Data Service</span></a></div>
            
            <div class="toc-item" style="margin-left:20px"><a href="#controller"><strong>3.2.4</strong><span>Controller</span></a></div>
            
            <div class="toc-item" style="margin-left:20px"><a href="#bootstrap"><strong>3.2.5</strong><span>Application Startup event</span></a></div>
            
            <div class="toc-item" style="margin-left:20px"><a href="#booktests"><strong>3.2.6</strong><span>Tests</span></a></div>
            
            <div class="toc-item" style="margin-left:0px"><a href="#runningTheApp"><strong>4</strong><span>Running the App</span></a></div>
            
            <div class="toc-item" style="margin-left:0px"><a href="#nextSteps"><strong>5</strong><span>Next Steps</span></a></div>
            
            <div style="clear:both" ></div>
        </div>
        
    </aside>
    <header>
        <h1>Micronaut Multitenancy Propagation</h1>
        <p>Learn how to Micronaut helps you implement Multitenancy in a set of Microservices.</p>
        <p><strong>Authors:</strong> Sergio del Amo</p>
        <p><strong>Micronaut Version:</strong> 1.0.0.BUILD-SNAPSHOT</p>
    </header>
    

<h1 id="gettingStarted">1 Getting Started</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-guides/micronaut-multitenancy-propagation/edit/master/src/main/docs/guide/gettingStarted.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Lets describe the microservices you are going to build through the tutorial.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>gateway</code> - A microservice which resolves a Tenant ID with a Cookie and propagates the Tenant ID to outgoing requests via HTTP Header.</p>
</li>
<li>
<p><code>books</code> - A microservice which uses <a href="http://gorm.grails.org">GORM</a> to provide data access layer with multitenacy support.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The next diagram illustrates the flow:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/tokenpropagation.svg" alt="tokenpropagation">
</div>
</div>


<h2 id="requirements">1.1 What you will need</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-guides/micronaut-multitenancy-propagation/edit/master/src/main/docs/guide/requirements.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>To complete this guide, you will need the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Some time on your hands</p>
</li>
<li>
<p>A decent text editor or IDE</p>
</li>
<li>
<p>JDK 1.8 or greater installed with <code>JAVA_HOME</code> configured appropriately</p>
</li>
</ul>
</div>


<h2 id="solution">1.2 Solution</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-guides/micronaut-multitenancy-propagation/edit/master/src/main/docs/guide/solution.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>We recommend you to follow the instructions in the next sections and create the app step by step. However, you can go right to the <strong>completed example</strong>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/micronaut-guides/micronaut-multitenancy-propagation/archive/master.zip">Download</a> and unzip the source</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Clone the <a href="https://git-scm.com/">Git</a> repository: <code>git clone <a href="https://github.com/micronaut-guides/micronaut-multitenancy-propagation.git" class="bare">https://github.com/micronaut-guides/micronaut-multitenancy-propagation.git</a></code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Then, <code>cd</code> into the <code>complete</code> folder which you will find in the root project of the downloaded/cloned project.</p>
</div>


<h1 id="usingSnapshotVersion">2 Using Snapshot Version</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-guides/micronaut-multitenancy-propagation/edit/master/src/main/docs/guide/usingSnapshotVersion.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>In this guide, we use some features which are currently only available in the <code>BUILD-SNAPSHOT</code> version of Micronaut.</p>
</div>
<div class="paragraph">
<p>Please, read <a href="https://docs.micronaut.io/snapshot/guide/index.html#usingsnapshots">Using snapshots</a> section of the Micronaut documentation.</p>
</div>


<h1 id="writingTheApp">3 Writing the App</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-guides/micronaut-multitenancy-propagation/edit/master/src/main/docs/guide/writingTheApp.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>We are going to write the app first without token propagation. Then we are going to configure token propagation and you will see how much code we can get rid of.</p>
</div>


<h2 id="gateway">3.1 Gateway</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-guides/micronaut-multitenancy-propagation/edit/master/src/main/docs/guide/writingTheApp/gateway.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Create the microservice:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash" data-lang="bash">mn create-app example.micronaut.gateway</code></pre>
</div>
</div>


<h2 id="multitenancyconfiguration">3.1.1 Multitenancy Configuration</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-guides/micronaut-multitenancy-propagation/edit/master/src/main/docs/guide/writingTheApp/gateway/multitenancyconfiguration.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Multi-Tenancy, as it relates to software development, is when a single instance of an application is used to service multiple clients (tenants) in a way that each tenants' data is isolated from the other.</p>
</div>
<div class="paragraph">
<p>To use the Micronaut’s multitenancy capabilities you must have the multitenancy dependency on your classpath. For example in <code>build.gradle:</code></p>
</div>
<div class="listingblock">
<div class="title">gateway/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">    compile "io.micronaut:multitenancy"</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">gateway/src/main/resources/application.yml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">micronaut:
...

    multitenancy:
        propagation:
            enabled: true <i class="conum" data-value="1"></i><b>(1)</b>
            service-id-regex: 'books' <i class="conum" data-value="2"></i><b>(2)</b>
        tenantresolver:
            cookie:
                enabled: true <i class="conum" data-value="3"></i><b>(3)</b>
        tenantwriter:
            httpheader:
                enabled: true <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Enable tenant propagation.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Propagate the resolved tenant ID only in requests going to a particular set of services. In our example, we define a regex to match the service id <code>books</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>In the gateway we use the <a href="https://docs.micronaut.io/snapshot/api/io/micronaut/multitenancy/tenantresolver/CookieTenantResolver.html">CookieTenantResolver</a> which resolves the current tenant from an HTTP cookie.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>We propagate the tenant with a <a href="https://docs.micronaut.io/snapshot/api/io/micronaut/multitenancy/writer/HttpHeaderTenantWriter.html">HttpHeaderTenantWriter</a> which writes the current tenant to a HTTP Header.</td>
</tr>
</table>
</div>


<h2 id="filter">3.1.2 Http Server Filter</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-guides/micronaut-multitenancy-propagation/edit/master/src/main/docs/guide/writingTheApp/gateway/filter.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>The Micronaut HTTP server supports the ability to apply filters to request/response processing in a similar, but reactive, way to Servlet filters in traditional Java applications.</p>
</div>
<div class="paragraph">
<p>Create a filter to redirect to <code>/tenant</code> if you attempt to access <code>/</code> without a cookie. That it is to say, in a situation where the application is not able to resolve the tenant ID.</p>
</div>
<div class="listingblock">
<div class="title">gateway/src/main/java/example/micronaut/HomePageFilter.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">package example.micronaut;

import io.micronaut.core.async.publisher.Publishers;
import io.micronaut.http.HttpRequest;
import io.micronaut.http.HttpResponse;
import io.micronaut.http.MutableHttpResponse;
import io.micronaut.http.annotation.Filter;
import io.micronaut.http.filter.OncePerRequestHttpServerFilter;
import io.micronaut.http.filter.ServerFilterChain;
import io.micronaut.multitenancy.exceptions.TenantNotFoundException;
import io.micronaut.multitenancy.tenantresolver.CookieTenantResolverConfiguration;
import io.micronaut.multitenancy.tenantresolver.TenantResolver;
import org.reactivestreams.Publisher;

import java.net.URI;

@Filter("/") <i class="conum" data-value="1"></i><b>(1)</b>
public class HomePageFilter extends OncePerRequestHttpServerFilter {

    private final TenantResolver tenantResolver;

    public HomePageFilter(TenantResolver tenantResolver) { <i class="conum" data-value="2"></i><b>(2)</b>
        this.tenantResolver = tenantResolver;
    }

    @Override
    protected Publisher&lt;MutableHttpResponse&lt;?&gt;&gt; doFilterOnce(HttpRequest&lt;?&gt; request, ServerFilterChain chain) {
        try {
            tenantResolver.resolveTenantIdentifier();
        } catch (TenantNotFoundException e) {
            return Publishers.just(HttpResponse.seeOther(URI.create("/tenant")));
        }
        return chain.proceed(request);
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>You can match only a subset of paths with a server filter.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Constructor injection.</td>
</tr>
</table>
</div>


<h2 id="client">3.1.3 Http Client</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-guides/micronaut-multitenancy-propagation/edit/master/src/main/docs/guide/writingTheApp/gateway/client.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Create an interface to encapsulate the communication with the <code>books</code> microservice which we will create shortly.</p>
</div>
<div class="listingblock">
<div class="title">gateway/src/main/java/example/micronaut/BookFetcher.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">package example.micronaut;

import io.reactivex.Single;

import java.util.List;

public interface BookFetcher {

    Single&lt;List&lt;String&gt;&gt; fetchBooks();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Create a <a href="https://docs.micronaut.io/snapshot/guide/index.html#clientAnnotation">declarative HTTP client</a>:</p>
</div>
<div class="listingblock">
<div class="title">gateway/src/main/java/example/micronaut/BookClient.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">package example.micronaut;

import io.micronaut.context.annotation.Requires;
import io.micronaut.context.env.Environment;
import io.micronaut.http.annotation.Get;
import io.micronaut.http.client.annotation.Client;
import io.reactivex.Single;

import java.util.List;

@Client("books") <i class="conum" data-value="1"></i><b>(1)</b>
@Requires(notEnv = Environment.TEST) <i class="conum" data-value="2"></i><b>(2)</b>
public interface BookClient extends BookFetcher {

    @Override
    @Get("/books") <i class="conum" data-value="3"></i><b>(3)</b>
    Single&lt;List&lt;String&gt;&gt; fetchBooks();
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>@Client</code> annotation uses a service id which matches the regular expression we defined in the propagation configuration.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We don&#8217;t want to load this bean in the <code>test</code> environment.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We configure the path <code>/books</code> and HTTP method of the endpoint exposed by <code>books</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Configure the urls for the service id <code>books</code>. Modify <code>application.yml</code></p>
</div>
<div class="listingblock">
<div class="title">gateway/src/main/resources/application.yml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">micronaut:
...

    http:
        services:
            books: <i class="conum" data-value="1"></i><b>(1)</b>
                urls:
                - "http://localhost:8081" <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Same id we used with <code>@Client</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>url where the <code>books</code> service will reside.</td>
</tr>
</table>
</div>


<h2 id="homecontroller">3.1.4 Home Controller</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-guides/micronaut-multitenancy-propagation/edit/master/src/main/docs/guide/writingTheApp/gateway/homecontroller.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>The <code>views</code> module provides support for view rendering on the server side and does so by rendering views on the I/O thread pool in order to avoid blocking the Netty event loop. Add the <code>views</code> dependency to  <code>build.gradle:</code></p>
</div>
<div class="listingblock">
<div class="title">gateway/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">    compile "io.micronaut:views"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Micronaut includes <a href="https://docs.micronaut.io/snapshot/api/io/micronaut/views/handlebars/HandlebarsViewsRenderer.html">HandlebarsViewsRenderer</a> which uses the <a href="http://jknack.github.io/handlebars.java/">Handlebars.java</a> project.</p>
</div>
<div class="paragraph">
<p>In addition to the <code>views</code> dependency, add the following dependency to <code>build.gradle</code></p>
</div>
<div class="listingblock">
<div class="title">gateway/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">    runtime "com.github.jknack:handlebars:4.1.0"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Create a view which we will use in the <code>HomeController</code>.</p>
</div>
<div class="listingblock">
<div class="title">gateway/src/main/resources/views/home.hbs</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;{{ pagetitle }}&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;ul&gt;
{{#each books}}
    &lt;li&gt;&lt;span&gt;{{ this }}&lt;/span&gt;&lt;/li&gt;
{{/each}}
&lt;/ul&gt;
&lt;p&gt;&lt;a href="/tenant"&gt;change tenant&lt;/a&gt;&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Create a <code>HomeController</code> which invokes <code>BookClient::fetchBooks()</code> and renders the books using the previous handlebar view.</p>
</div>
<div class="listingblock">
<div class="title">gateway/src/main/java/example/micronaut/HomeController.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">package example.micronaut;

import io.micronaut.http.HttpResponse;
import io.micronaut.http.annotation.Controller;
import io.micronaut.http.annotation.Get;
import io.micronaut.views.View;
import io.reactivex.Single;

import java.util.HashMap;
import java.util.Map;

@Controller("/") <i class="conum" data-value="1"></i><b>(1)</b>
public class HomeController {

    private final BookFetcher bookFetcher;

    public HomeController(BookFetcher bookFetcher) { <i class="conum" data-value="2"></i><b>(2)</b>
        this.bookFetcher = bookFetcher;
    }

    @View("home") <i class="conum" data-value="3"></i><b>(3)</b>
    @Get <i class="conum" data-value="4"></i><b>(4)</b>
    Single&lt;HttpResponse&lt;Map&lt;String, Object&gt;&gt;&gt; index() { <i class="conum" data-value="5"></i><b>(5)</b>
        return bookFetcher.fetchBooks().map(books -&gt; {
            Map&lt;String, Object&gt; model = new HashMap&lt;&gt;();
            model.put("pagetitle", "Home");
            model.put("books", books);
            return HttpResponse.ok(model);
        });
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Annotate with <code>io.micronaut.http.annotation.Controller</code> to designate a class as a Micronaut’s controller.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Constructor dependency injection</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Use <code>@View</code> annotation to indicate the view name which should be used to render a view for the route.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>You can specify the HTTP verb that a controller’s action responds to. To respond to a GET request, use the <code>io.micronaut.http.annotation.Get</code> annotation.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>A RxJava <a href="http://reactivex.io/RxJava/2.x/javadoc/io/reactivex/Single.html">Single</a> is returned with the value read from the server.</td>
</tr>
</table>
</div>


<h2 id="cookieRedirect">3.1.5 Cookie Redirect</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-guides/micronaut-multitenancy-propagation/edit/master/src/main/docs/guide/writingTheApp/gateway/cookieRedirect.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p><code>HomePageFilter</code> redirects to <code>/tenant</code> when the tenant ID is not resolved. Create <code>TenantController</code> to handle that endpoint:</p>
</div>
<div class="listingblock">
<div class="title">gateway/src/main/java/example/micronaut/TenantController.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">package example.micronaut;

import io.micronaut.http.HttpResponse;
import io.micronaut.http.HttpStatus;
import io.micronaut.http.annotation.Controller;
import io.micronaut.http.annotation.Get;
import io.micronaut.http.cookie.Cookie;
import io.micronaut.multitenancy.tenantresolver.CookieTenantResolverConfiguration;
import io.micronaut.views.View;

import java.net.URI;
import java.util.Arrays;
import java.util.HashMap;
import java.util.Map;

@Controller("/tenant") <i class="conum" data-value="1"></i><b>(1)</b>
public class TenantController {
    private final CookieTenantResolverConfiguration cookieTenantResolverConfiguration;

    public TenantController(CookieTenantResolverConfiguration cookieTenantResolverConfiguration) { <i class="conum" data-value="2"></i><b>(2)</b>
        this.cookieTenantResolverConfiguration = cookieTenantResolverConfiguration;
    }

    @View("tenant") <i class="conum" data-value="3"></i><b>(3)</b>
    @Get <i class="conum" data-value="4"></i><b>(4)</b>
    public Map&lt;String, Object&gt; index() {
        Map&lt;String, Object&gt; model = new HashMap&lt;&gt;();
        model.put("pagetitle", "Tenants");
        model.put("tenants", Arrays.asList("sherlock", "watson"));
        return model;
    }

    @Get("/{tenant}") <i class="conum" data-value="5"></i><b>(5)</b>
    public HttpResponse tenant(String tenant) {
        final String path = "/";
        final String cookieName = cookieTenantResolverConfiguration.getCookiename();
        return HttpResponse.status(HttpStatus.FOUND).headers((headers) -&gt;
                headers.location(URI.create(path))
        ).cookie(Cookie.of(cookieName, tenant).path(path)); <i class="conum" data-value="6"></i><b>(6)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The class is defined as a controller with the <code>@Controller</code> annotation mapped to the path <code>/tenant</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Constructor injection of <code>CookieTenantResolverConfiguration</code>. A configuration object which is used by the <code>CookieTenantResolver`</code></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Use <code>@View</code> annotation to indicate the view name which should be used to render a view for the route.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>You can specify the HTTP verb that a controller’s action responds to. To respond to a GET request, use the <code>io.micronaut.http.annotation.Get</code> annotation.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Define a path variable <code>tenant</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Do a 302 redirect to <code>/</code> setting a cookie with the selected tenant ID.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The previous controller renders the <code>tenant</code> view.</p>
</div>
<div class="listingblock">
<div class="title">gateway/src/main/resources/views/tenant.hbs</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;{{ pagetitle }}&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;ul&gt;
{{#each tenants}}
    &lt;li&gt;&lt;a href="/tenant/{{ this }}"&gt;{{ this }}&lt;/a&gt;&lt;/li&gt;
{{/each}}
&lt;/ul&gt;

&lt;p&gt;&lt;a href="/"&gt;Go to Home&lt;/a&gt;&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>


<h2 id="tests">3.1.6 Tests</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-guides/micronaut-multitenancy-propagation/edit/master/src/main/docs/guide/writingTheApp/gateway/tests.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Add <code>inject-groovy</code> as a <code>testCompile</code> dependency to define beans in Groovy in the test classpath.</p>
</div>
<div class="listingblock">
<div class="title">gateway/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy" data-lang="groovy">    testCompile "io.micronaut:inject-groovy"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Provide a <code>BookFetcher</code> bean replacement for the Test environment.</p>
</div>
<div class="listingblock">
<div class="title">gateway/src/test/groovy/example/micronaut/MockBookFetcher.groovy</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">package example.micronaut

import io.micronaut.context.annotation.Requires
import io.micronaut.context.env.Environment
import io.reactivex.Single

import javax.inject.Singleton

@Singleton
@Requires(env = Environment.TEST)
class MockBookFetcher implements BookFetcher {

    @Override
    Single&lt;List&lt;String&gt;&gt; fetchBooks() {
        Single.just(Arrays.asList("The Empty Hearse",
                "The Hounds of Baskerville",
                "The Woman",
                "The Six Thatchers",
                "The Aluminium Crutch",
                "The Speckled Blonde",
                "The Geek Interpreter",
                "The Great Game",
                "The Blind Banker",
                "A Study in Pink"))
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Create a tests which verifies the flow using Geb.</p>
</div>
<div class="listingblock">
<div class="title">gateway/src/test/groovy/example/micronaut/HomePageSpec.groovy</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">package example.micronaut

import geb.spock.GebSpec
import io.micronaut.context.ApplicationContext
import io.micronaut.runtime.server.EmbeddedServer
import spock.lang.AutoCleanup
import spock.lang.IgnoreIf
import spock.lang.Shared

class HomePageSpec extends GebSpec {
    @Shared
    @AutoCleanup
    EmbeddedServer embeddedServer = ApplicationContext.run(EmbeddedServer)

    @IgnoreIf({ !(sys['geb.env'] in ['chrome', 'firefox']) })
    def "verify tenant can be selected works"() {
        given:
        browser.baseUrl = "http://localhost:${embeddedServer.port}"

        when:
        go "/"

        then:
        at TenantPage

        when:
        TenantPage page = browser.page(TenantPage)
        page.select("sherlock")

        then:
        at HomePage

        when:
        HomePage homePage = browser.page(HomePage)

        then:
        homePage.numberOfBooks()
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>To run the application from a unit test you can use the <a href="http://docs.micronaut.io/snapshot/api/io/micronaut/runtime/server/EmbeddedServer.html">EmbeddedServer</a> interface.</td>
</tr>
</table>
</div>


<h2 id="books">3.2 Books Microservice</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-guides/micronaut-multitenancy-propagation/edit/master/src/main/docs/guide/writingTheApp/books.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Create the microservice:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash" data-lang="bash">mn create-app example.micronaut.books --lang groovy</code></pre>
</div>
</div>


<h2 id="gorm">3.2.1 GORM</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-guides/micronaut-multitenancy-propagation/edit/master/src/main/docs/guide/writingTheApp/books/gorm.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p><a href="http://gorm.grails.org">GORM</a> is a powerful Groovy-based data access toolkit for the JVM. To use it in Micronaut add the following dependencies to <code>build.gradle</code>:</p>
</div>
<div class="listingblock">
<div class="title">books/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy" data-lang="groovy">    compile("io.micronaut.configuration:hibernate-gorm") {
        exclude group: 'org.grails', module: 'grails-datastore-gorm-hibernate5'
    }
    compile "org.grails:grails-datastore-gorm-hibernate5:6.1.9.RELEASE"
    runtime "com.h2database:h2:1.4.192"
    runtime "org.apache.tomcat:tomcat-jdbc:8.5.0"
    runtime "org.apache.tomcat.embed:tomcat-embed-logging-log4j:8.5.0"
    runtime "org.slf4j:slf4j-api:1.7.10"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Configure multiple data sources as described in the <a href="http://gorm.grails.org/latest/hibernate/manual/index.html#multipleDataSources">GORM Multiple Data Sources</a> documentation.</p>
</div>
<div class="listingblock">
<div class="title">books/src/main/resources/application.yml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml" data-lang="yaml">hibernate:
    hbm2ddl:
        auto: 'update'
dataSources:
    sherlock:
        url: 'jdbc:h2:mem:sherlockDb;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE'
        username: 'sa'
        password: ''
        driverClassName: 'org.h2.Driver'
    watson:
        url: 'jdbc:h2:mem:watsonDb;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE'
        username: 'sa'
        password: ''
        driverClassName: 'org.h2.Driver'</code></pre>
</div>
</div>


<h2 id="domain">3.2.2 Domain</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-guides/micronaut-multitenancy-propagation/edit/master/src/main/docs/guide/writingTheApp/books/domain.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>GORM supports several <a href="http://gorm.grails.org/latest/hibernate/manual/index.html#_multi_tenancy_modes">tenancy modes</a>. In this tutorial we use <code>DATABASE</code> where a separate database with a separate connection pool is used to store each tenants data.</p>
</div>
<div class="paragraph">
<p>Add the following configuration to <code>application.yml</code></p>
</div>
<div class="listingblock">
<div class="title">books/src/main/resources/application.yml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml" data-lang="yaml">grails:
    gorm:
        multiTenancy:
            mode: DATABASE <i class="conum" data-value="1"></i><b>(1)</b>
            tenantResolverClass: 'io.micronaut.multitenancy.gorm.HttpHeaderTenantResolver' <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Use <code>DATABASE</code> mode.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Use <code>HttpHeaderTenantResolver</code> which resolves the tenant ID from an HTTP header. Remember we configured the <code>gateway</code> microservice to propagate the tenant ID in an HTTP Header.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Create a GORM Entity to persist books:</p>
</div>
<div class="listingblock">
<div class="title">books/src/main/groovy/example/micronaut/Book.groovy</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy" data-lang="groovy">package example.micronaut

import grails.gorm.MultiTenant
import grails.gorm.annotation.Entity
import org.grails.datastore.gorm.GormEntity

@Entity <i class="conum" data-value="1"></i><b>(1)</b>
class Book implements GormEntity&lt;Book&gt;, <i class="conum" data-value="2"></i><b>(2)</b>
                MultiTenant { <i class="conum" data-value="3"></i><b>(3)</b>
    String title

    static constraints = {
        title nullable: false, blank: false
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>GORM entities are annotated with <code>grails.persistence.Entity</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Use of <code>GormEntity</code> is merely to aid IDE support outside of Grails. When used inside a Grails context, some IDEs will use the grails-app/domain location as a hint to enable code completion.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Implement the <code>MultiTenant</code> trait in the GORM entities you want to be regarded as multi tenant.</td>
</tr>
</table>
</div>


<h2 id="dataservice">3.2.3 Data Service</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-guides/micronaut-multitenancy-propagation/edit/master/src/main/docs/guide/writingTheApp/books/dataservice.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>GORM Data Services take the work out of implemented service layer logic by adding the ability to automatically implement abstract classes or interfaces using GORM logic.</p>
</div>
<div class="listingblock">
<div class="title">books/src/main/groovy/example/micronaut/BookService.groovy</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy" data-lang="groovy">package example.micronaut

import grails.gorm.multitenancy.CurrentTenant
import grails.gorm.services.Service

@CurrentTenant <i class="conum" data-value="1"></i><b>(1)</b>
@Service(Book) <i class="conum" data-value="2"></i><b>(2)</b>
interface BookService {
    Book save(String title)
    List&lt;Book&gt; findAll()
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Resolve the current tenant for the context of a class or method</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>@Service</code> annotation is an AST transformation that will automatically implement the service for you.</td>
</tr>
</table>
</div>


<h2 id="controller">3.2.4 Controller</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-guides/micronaut-multitenancy-propagation/edit/master/src/main/docs/guide/writingTheApp/books/controller.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Create a controller to expose the <code>/books</code> endpoint.</p>
</div>
<div class="listingblock">
<div class="title">books/src/main/groovy/example/micronaut/BookController.groovy</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy" data-lang="groovy">package example.micronaut

import io.micronaut.http.annotation.Controller
import io.micronaut.http.annotation.Get

@Controller("/books") <i class="conum" data-value="1"></i><b>(1)</b>
class BookController {

    private final BookService bookService

    BookController(BookService bookService) { <i class="conum" data-value="2"></i><b>(2)</b>
        this.bookService = bookService
    }

    @Get
    List&lt;String&gt; index() {
        bookService.findAll()*.title
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Annotate with <code>io.micronaut.http.annotation.Controller</code> to designate a class as a Micronaut’s controller.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Constructor dependency injection.</td>
</tr>
</table>
</div>


<h2 id="bootstrap">3.2.5 Application Startup event</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-guides/micronaut-multitenancy-propagation/edit/master/src/main/docs/guide/writingTheApp/books/bootstrap.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>To listen to an event, register a bean that implements <code>ApplicationEventListener</code> where the generic type is the type of event the listener should be executed for.</p>
</div>
<div class="paragraph">
<p>We want to listen for the <code>StartupEvent</code> to save some elements in the databases when the app starts:</p>
</div>
<div class="listingblock">
<div class="title">books/src/main/groovy/example/micronaut/Bootstrap.groovy</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy" data-lang="groovy">package example.micronaut

import grails.gorm.multitenancy.Tenants
import io.micronaut.context.event.ApplicationEventListener
import io.micronaut.context.event.StartupEvent

import javax.inject.Inject
import javax.inject.Singleton

@Singleton <i class="conum" data-value="1"></i><b>(1)</b>
class Bootstrap implements ApplicationEventListener&lt;StartupEvent&gt; { <i class="conum" data-value="2"></i><b>(2)</b>

    @Inject <i class="conum" data-value="3"></i><b>(3)</b>
    BookService bookService

    @Override
    void onApplicationEvent(StartupEvent event) {

        Tenants.withId("sherlock") { <i class="conum" data-value="4"></i><b>(4)</b>
            bookService.save('Sherlock diary')
        }
        Tenants.withId("watson") { <i class="conum" data-value="4"></i><b>(4)</b>
            bookService.save('Watson diary')
        }
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>To register a Singleton in Micronaut’s application context, annotate your class with <code>javax.inject.Singleton</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Listen to <code>StartupEvent</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Field injection</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>You can specify the tenant ID with the <code>Tenants.withId</code> method.</td>
</tr>
</table>
</div>


<h2 id="booktests">3.2.6 Tests</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-guides/micronaut-multitenancy-propagation/edit/master/src/main/docs/guide/writingTheApp/books/booktests.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Create a tests which verifies the behaviour. We received the books belonging to the tenant which we send via an HTTP header.</p>
</div>
<div class="listingblock">
<div class="title">books/src/test/groovy/example/micronaut/BookControllerSpec.groovy</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">package example.micronaut

import io.micronaut.context.ApplicationContext
import io.micronaut.core.type.Argument
import io.micronaut.http.HttpRequest
import io.micronaut.http.client.RxHttpClient
import io.micronaut.runtime.server.EmbeddedServer
import spock.lang.AutoCleanup
import spock.lang.Shared
import spock.lang.Specification

class BookControllerSpec extends Specification {

    @Shared
    @AutoCleanup
    EmbeddedServer embeddedServer = ApplicationContext.run(EmbeddedServer)

    @Shared
    @AutoCleanup
    RxHttpClient client = embeddedServer.applicationContext.createBean(RxHttpClient, embeddedServer.getURL())

    void "test hello world response"() {
        when:
        HttpRequest request = HttpRequest.GET('/books').header("tenantId", "sherlock")
        List&lt;String&gt; rsp  = client.toBlocking().retrieve(request, Argument.of(List, String))

        then:
        rsp
        rsp == ['Sherlock diary']

        when:
        request = HttpRequest.GET('/books').header("tenantId", "watson")
        rsp  = client.toBlocking().retrieve(request, Argument.of(List, String))

        then:
        rsp
        rsp == ['Watson diary']
    }


}</code></pre>
</div>
</div>


<h1 id="runningTheApp">4 Running the App</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-guides/micronaut-multitenancy-propagation/edit/master/src/main/docs/guide/runningTheApp.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Run both microservices:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash" data-lang="bash">books $ ./gradlew run
&gt; Task :complete/books:run
18:29:26.500 [main] INFO  io.micronaut.runtime.Micronaut - Startup completed in 671ms. Server Running: http://localhost:8081
&lt;=========----&gt; 75% EXECUTING [10s]</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash" data-lang="bash">gateway $ ./gradlew run

&gt; Task :complete/gateway:run
18:28:35.723 [main] INFO  io.micronaut.runtime.Micronaut - Startup completed in 707ms. Server Running: http://localhost:8080</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can visit <code><a href="http://localhost:8080" class="bare">http://localhost:8080</a></code> and change tenant and see the book list change:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/multitenancy.gif" alt="multitenancy">
</div>
</div>


<h1 id="nextSteps">5 Next Steps</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-guides/micronaut-multitenancy-propagation/edit/master/src/main/docs/guide/nextSteps.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Read more about <a href="https://docs.micronaut.io/snapshot/guide/index.html#multitenancy">Multitenancy</a> inside Micronaut and <a href="http://gorm.grails.org/latest/hibernate/manual/index.html#multiTenancy">GORM Multitenancy support</a>.</p>
</div>

</article>
</div>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-115754405-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-115754405-1');
</script>
</body>
</html>

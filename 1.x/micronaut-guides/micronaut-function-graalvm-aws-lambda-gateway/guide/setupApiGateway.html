<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <title>5 Connecting our Lambda to API Gateway null</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8"/>
    <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8"/>
    <script type="text/javascript">
function addJsClass() {
    var classes = document.body.className.split(" ");
    classes.push("js");
    document.body.className = classes.join(" ");
}
    </script>
</head>

<body class="body" onload="addJsClass();">
<div id="navigation">
    <div class="navTitle">
        
        Micronaut Functions in GraalVM Native Images deployed to AWS Lambda
    </div>
    <div class="navLinks">
        <ul>
            <li>
                <div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)">
                    <a href="../guide/index.html" class="button">Table of contents</a>

                    <div id="nav-summary-childs" style="display:none;">
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/gettingStarted.html"><strong>1</strong><span>Introduction</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/writingTheApp.html"><strong>2</strong><span>Writing the Application</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/samLocal.html"><strong>3</strong><span>Running Lambda Locally via SAM</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/deployToLambda.html"><strong>4</strong><span>Deploying to AWS Lambda</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/setupApiGateway.html"><strong>5</strong><span>Connecting our Lambda to API Gateway</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/nextSteps.html"><strong>6</strong><span>Next Steps</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/help.html"><strong>7</strong><span>Help with Micronaut</span></a>
                        </div>
                        
                    </div>
                </div>
            </li>
            <li class="separator selected">
                <a id="ref-button" onclick="localToggle(); return false;" href="#">Quick Reference</a>
            </li>
        </ul>
    </div>


</div>

<table id="colset" border="0" cellpadding="0" cellspacing="0">
    <tr>
        <td id="col1">
            <div id="main" class="corner-all">

                
                    <div class="toc-item prev-left"><a href="../guide/deployToLambda.html">&lt;&lt; <strong>4</strong><span>Deploying to AWS Lambda</span></a></div>
                

                <span id='toggle-col1' class="toggle">(<a href="#" onclick="localToggle(); return false;">Quick Reference</a>)</span>

                
                    <div class="toc-item next-right"><a href="../guide/nextSteps.html"><strong>6</strong><span>Next Steps</span> >></a></div>
                


                <div class="project">
                    <h1>5 Connecting our Lambda to API Gateway</h1>

                    <p><strong>Version:</strong> null</p>
                </div>

                

                

<h1 id="setupApiGateway">5 Connecting our Lambda to API Gateway</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-guides/micronaut-function-graalvm-aws-lambda-gateway/edit/master/src/main/docs/guide/setupApiGateway.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Let&#8217;s get our Lambda an API Gateway trigger!</p>
</div>
<div class="paragraph">
<p>Navigate to <a href="https://console.aws.amazon.com/apigateway/home" class="bare">https://console.aws.amazon.com/apigateway/home</a> and click on the "Get Started" button in the middle of the screen.
If you&#8217;ve created an API Gateway in the past, you&#8217;ll instead need to click "Create API" in the top right.</p>
</div>
<div class="paragraph">
<p>You&#8217;ll be presented with an Example API, but we want to create our own. Select the "New API" radio and give the API a name, then click "Create API"</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/gateway-1-create-inputs.png" alt="gateway 1 create inputs">
</div>
</div>
<div class="paragraph">
<p>Now that we have our API, we need to create a catch-all "proxy" resource for our Lambda (we want our Micronaut app to handle routing).</p>
</div>
<div class="paragraph">
<p>Use the "Actions" dropdown and select "Create Resource"</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/gateway-2-create-resource.png" alt="gateway 2 create resource">
</div>
</div>
<div class="paragraph">
<p>Checking the "Configure as proxy resource" checkbox will automatically fill in the name and path, then we just need to click "Create Resource"</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/gateway-3-proxy.png" alt="gateway 3 proxy">
</div>
</div>
<div class="paragraph">
<p>Next we need to connect this API to our lambda.</p>
</div>
<div class="paragraph">
<p>"Lambda Function Proxy" should already be selected, so just start typing our lambda&#8217;s name in the in the
"Lambda Function" autocomplete box and select it once it pops up. Then click "Save"</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/gateway-4-connect-lambda.png" alt="gateway 4 connect lambda">
</div>
</div>
<div class="paragraph">
<p>At this point, we can use the AWS console to test out triggering our API, using the "Test" button on the left hand side of
resource visualization.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/gateway-5-test-the-api.png" alt="gateway 5 test the api">
</div>
</div>
<div class="paragraph">
<p>As our app is expecting <code>GET</code> requests at <code>/find-primes-below/{number}</code>, that&#8217;s how we&#8217;ll fill in the test details.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/gateway-6-test-details.png" alt="gateway 6 test details">
</div>
</div>
<div class="paragraph">
<p>You should receive a 200 response with the list of primes.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/gateway-7-test-success.png" alt="gateway 7 test success">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you get an error, check the "Path" input box to ensure it matches the path of your controller method, and check
the Lambda config to ensure the function zip uploaded successfully.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We&#8217;re almost to the finish line now! We&#8217;ve confirmed that everything works properly, but our API is not yet publicly accessible.</p>
</div>
<div class="paragraph">
<p>To make that happen, we need to "Deploy" our API. From the "Actions" dropdown, select "Deploy API"</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/gateway-8-deploy-api.png" alt="gateway 8 deploy api">
</div>
</div>
<div class="paragraph">
<p>APIs can be deployed in "Stages". Commonly you might have a "test" and "prod" stage where changes would naturally propagate,
but for the purposes of this guide we&#8217;ll just create one new stage called "demo".</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/gateway-9-deploy-details.png" alt="gateway 9 deploy details">
</div>
</div>
<div class="paragraph">
<p>Click "Deploy", and we should get the URL for our newly deployed API!</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/gateway-10-deploy-success-url-display.png" alt="gateway 10 deploy success url display">
</div>
</div>
<div class="paragraph">
<p>Now we can use any API client we like to test our new url.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/gateway-11-curl.png" alt="gateway 11 curl">
</div>
</div>
<div class="paragraph">
<p>Congratulations! You&#8217;ve got yourself your first Micronaut GraalVM API with AWS!</p>
</div>


                <div style="clear:both;margin-top:15px;"></div>
                
                    <div class="toc-item prev-left"><a href="../guide/deployToLambda.html">&lt;&lt; <strong>4</strong><span>Deploying to AWS Lambda</span></a></div>
                
                    <div class="toc-item next-right"><a href="../guide/nextSteps.html"><strong>6</strong><span>Next Steps</span> >></a></div>
                
                <div style="clear:both"></div>
            </div>
        </td>
        <td id="col2">
            <div class="local clearfix">
                <div class="local-title">
                    <a href="../guide/index.html" target="mainFrame">Quick Reference</a>
                    <span class="toggle">(<a href="#" onclick="localToggle(); return false;">hide</a>)</span>
                </div>
                <div class="menu">
                    
                </div>
            </div>
        </td>
    </tr>
</table>

<div id="footer">
    Copies of this document may be made for your own use and for distribution to others, provided that you do not charge any fee for such copies and further provided that each copy contains this Copyright Notice, whether distributed in print or electronically. All guides are released with an ASLv2 license for the code, and Creative Commons license for the writing. 
    
</div>

<script type="text/javascript" src="../js/docs.js"></script>

</body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <title>5 Stadiums with @EachProperty null</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8"/>
    <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8"/>
    <script type="text/javascript">
function addJsClass() {
    var classes = document.body.className.split(" ");
    classes.push("js");
    document.body.className = classes.join(" ");
}
    </script>
</head>

<body class="body" onload="addJsClass();">
<div id="navigation">
    <div class="navTitle">
        
        @Configuration and @ConfigurationBuilder
    </div>
    <div class="navLinks">
        <ul>
            <li>
                <div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)">
                    <a href="../guide/index.html" class="button">Table of contents</a>

                    <div id="nav-summary-childs" style="display:none;">
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/gettingStarted.html"><strong>1</strong><span>Getting Started</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/writingTheApp.html"><strong>2</strong><span>Writing the Application</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/configurationProperties.html"><strong>3</strong><span>Team Configuration with @ConfigurationProperties</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/configurationBuilder.html"><strong>4</strong><span>Team Admin Builder with @ConfigurationBuilder</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/eachProperty.html"><strong>5</strong><span>Stadiums with @EachProperty</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/runningTheApp.html"><strong>6</strong><span>Running the Application</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/controller.html"><strong>7</strong><span>Controller</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/graal.html"><strong>8</strong><span>Generating a Micronaut Application's Native Image with GraalVM</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/next.html"><strong>9</strong><span>Where To Go From Here?</span></a>
                        </div>
                        
                    </div>
                </div>
            </li>
            <li class="separator selected">
                <a id="ref-button" onclick="localToggle(); return false;" href="#">Quick Reference</a>
            </li>
        </ul>
    </div>


</div>

<table id="colset" border="0" cellpadding="0" cellspacing="0">
    <tr>
        <td id="col1">
            <div id="main" class="corner-all">

                
                    <div class="toc-item prev-left"><a href="../guide/configurationBuilder.html">&lt;&lt; <strong>4</strong><span>Team Admin Builder with @ConfigurationBuilder</span></a></div>
                

                <span id='toggle-col1' class="toggle">(<a href="#" onclick="localToggle(); return false;">Quick Reference</a>)</span>

                
                    <div class="toc-item next-right"><a href="../guide/runningTheApp.html"><strong>6</strong><span>Running the Application</span> >></a></div>
                


                <div class="project">
                    <h1>5 Stadiums with @EachProperty</h1>

                    <p><strong>Version:</strong> null</p>
                </div>

                
                <div id="table-of-content">
                    <h2>Table of Contents</h2>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#eachPropertyTest"><strong>5.1</strong><span>Test @EachProperty</span></a>
                    </div>
                    
                </div>
                

                

<h1 id="eachProperty">5 Stadiums with @EachProperty</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-guides/micronaut-configuration-kotlin/edit/master/src/main/docs/guide/eachProperty.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Micronaut is also able to read a "list" of configurations that are related. Imagine we would like to declare stadiums and their
attributes.</p>
</div>
<div class="listingblock">
<div class="title">src/main/resources/application.yml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yml" data-lang="yml">stadium:
  coors: <i class="conum" data-value="1"></i><b>(1)</b>
    city: 'Denver'
    size: 50000
  pnc:
    city: 'Pittsburgh'
    size: 35000</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This element will be the name of the bean.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We can use <code>@EachProperty</code> which will cycle through the configuration and read each nested clause as a bean. The higher level
property will be parameterized as the name.</p>
</div>
<div class="listingblock">
<div class="title">src/main/kotlin/example/micronaut/StadiumConfiguration.kt</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin" data-lang="kotlin">package example.micronaut

import io.micronaut.context.annotation.EachProperty
import io.micronaut.context.annotation.Parameter
import io.micronaut.core.annotation.Introspected

@Introspected
@EachProperty("stadium") <i class="conum" data-value="1"></i><b>(1)</b>
class StadiumConfiguration
constructor(@param:Parameter val name: String) {  <i class="conum" data-value="2"></i><b>(2)</b>
    var city: String? = null
    var size: Int? = null
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Establish the top layer of configuration</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>name</code> is read in from the property key and send as a parameter to the bean.</td>
</tr>
</table>
</div>


<h2 id="eachPropertyTest">5.1 Test @EachProperty</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-guides/micronaut-configuration-kotlin/edit/master/src/main/docs/guide/eachPropertyTest.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Validate the configuration with a test. Notice multiple beans are created from the configuration.  In a controller we can
inject a particular <code>StadiumConfiguration</code> instance bean by using the <code>@Named</code> parameter with qualifier name.</p>
</div>
<div class="listingblock">
<div class="title">src/test/kotlin/example/micronaut/StadiumConfigurationTest.kt</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin" data-lang="kotlin">package example.micronaut

import io.kotlintest.shouldBe
import io.kotlintest.specs.BehaviorSpec
import io.micronaut.context.ApplicationContext
import io.micronaut.inject.qualifiers.Qualifiers
import io.micronaut.test.annotation.MicronautTest

@MicronautTest
class StadiumConfigurationTest : BehaviorSpec({

    given("an application context started with configuration") {
        val items = mapOf("stadium.fenway.city" to "Boston", <i class="conum" data-value="1"></i><b>(1)</b>
                "stadium.fenway.size" to  60000,
                "stadium.wrigley.city" to  "Chicago", <i class="conum" data-value="1"></i><b>(1)</b>
                "stadium.wrigley.size" to 45000
        )
        val ctx = ApplicationContext.run(ApplicationContext::class.java, items)

        `when`("StadiumConfiguration are retrieved with bean qualifier") {
            val fenwayConfiguration = ctx.getBean(StadiumConfiguration::class.java, Qualifiers.byName("fenway"))  <i class="conum" data-value="2"></i><b>(2)</b>
            val wrigleyConfiguration = ctx.getBean(StadiumConfiguration::class.java, Qualifiers.byName("wrigley")) <i class="conum" data-value="2"></i><b>(2)</b>

            then("configuration properties are populated") {
                fenwayConfiguration.name shouldBe "fenway"
                fenwayConfiguration.size shouldBe 60000
                wrigleyConfiguration.name shouldBe "wrigley"
                wrigleyConfiguration.size shouldBe 45000
            }
        }

        ctx.close()
    }
})</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Multiple configurations can be declared for the same class.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Since there are multiple beans to retrieve a bean a <code>Qualifier</code> must be sent.</td>
</tr>
</table>
</div>


                <div style="clear:both;margin-top:15px;"></div>
                
                    <div class="toc-item prev-left"><a href="../guide/configurationBuilder.html">&lt;&lt; <strong>4</strong><span>Team Admin Builder with @ConfigurationBuilder</span></a></div>
                
                    <div class="toc-item next-right"><a href="../guide/runningTheApp.html"><strong>6</strong><span>Running the Application</span> >></a></div>
                
                <div style="clear:both"></div>
            </div>
        </td>
        <td id="col2">
            <div class="local clearfix">
                <div class="local-title">
                    <a href="../guide/index.html" target="mainFrame">Quick Reference</a>
                    <span class="toggle">(<a href="#" onclick="localToggle(); return false;">hide</a>)</span>
                </div>
                <div class="menu">
                    
                </div>
            </div>
        </td>
    </tr>
</table>

<div id="footer">
    Copies of this document may be made for your own use and for distribution to others, provided that you do not charge any fee for such copies and further provided that each copy contains this Copyright Notice, whether distributed in print or electronically. All guides are released with an ASLv2 license for the code, and Creative Commons license for the writing.
    
</div>

<script type="text/javascript" src="../js/docs.js"></script>

</body>
</html>
